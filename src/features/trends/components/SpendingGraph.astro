---
import { convertDate } from "../../../lib/convertDate";
import type { calcSpendingTotals } from "../utils/trendGraph.utils";
import BarGraph from "./BarGraph.astro";
import BarGraphItem from "./BarGraphItem.astro";
import GraphTitle from "./GraphTitle.astro";
import GraphWrapper from "./GraphWrapper.astro";

interface Props {
    monthRange : string[]
    spendingTotals : ReturnType<typeof calcSpendingTotals>
    upperRange : number
}

const { monthRange, spendingTotals, upperRange } = Astro.props
---

<GraphWrapper>
    <GraphTitle title="Spending over time" />
    <BarGraph>
        { monthRange.map((month) => (
            <BarGraphItem 
                title={convertDate(month).to("MMM-YY")}
                amount={`-${ spendingTotals[month]?.spending ?? 0 }`}
                type="spending" 
                heightRatio={(spendingTotals[month]?.spending ?? 0) / upperRange * 225} 
            />
        ))}
    </BarGraph>
</GraphWrapper>