---
import { ImportIcon } from "@lucide/astro";
---

<import-transactions 
    class="block bg-blue/10 py-16 rounded-xl text-xl font-semibold text-blue/90 text-center select-none border-2 border-transparent"
>
    <ImportIcon size={48} class="rotate-180 mx-auto" />
    Drag files here to import
</import-transactions>


<script>
import { el } from "../../../lib/el"

el('import-transactions', document, importTransactions => {

    importTransactions.addEventListener('dragover', e => {
        e.preventDefault()
        importTransactions.classList.add('border-blue')
        importTransactions.classList.remove('border-transparent')
    })

    importTransactions.addEventListener('dragleave', e => {
        e.preventDefault()
        importTransactions.classList.remove('border-blue')
        importTransactions.classList.add('border-transparent')
    })

    importTransactions.addEventListener('drop', (e: Event) => {
        e.preventDefault()
        const dragEvent = e as DragEvent

        importTransactions.classList.remove('border-blue')
        importTransactions.classList.add('border-transparent')

        const files = dragEvent.dataTransfer?.files
        if( !files || !files[0]) {
            return
        }

        const reader = new FileReader()
        reader.readAsText(files[0])
        reader.onload = e => {
            el<HTMLTextAreaElement>('#import-transactions-form textarea', document, textarea => {
                textarea.textContent = String(e.target?.result)
            })
        }
    })

})

</script>