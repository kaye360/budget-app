---
import { actions } from "astro:actions";
import TransactionListLayout from "../../../layouts/TransactionListLayout.astro";
import CreateTransaction from "../components/CreateTransaction";

const [transactionsResponse, budgetsResponse, accountsResponse] = await Promise.all([
    Astro.callAction( actions.transaction.byRecent, { perPage : 25 } ),
    Astro.callAction( actions.budget.index, {} ),
    Astro.callAction( actions.accounts.index, {} )
]) 

const transactions = transactionsResponse.error ? [] : transactionsResponse.data.list
const budgets = budgetsResponse.error ? [] : budgetsResponse.data
const accounts = accountsResponse.error ? [] : accountsResponse.data
---

<TransactionListLayout title="Add a Transaction">
    <CreateTransaction 
        transactions={transactions}
        budgets={budgets} 
        accounts={accounts} 
        client:only="react"
    />
</TransactionListLayout>
